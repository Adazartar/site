

names = [
    'Adam Mantello',
    'Matthew Pesavento',
    'Johnny',
    'Heisenberg',
    'Thong',
    'Walter White',
    'Skyler White yo',
    'Dick Fucker',
    'Hector Salamanca',
    'John Cena',
    'Gus Fring',
    'Saul Goodman',
    'TOMBO10GAMING',
    'Rick and Morty',
    'Walt Jr',
    'Jesse Pinkman',
    'Among Us Crewmate',
    'Aragorn',
    'Gandalf',
    'Sauron',
    'Francesca',
    'Mike Wizzaoweski',
    'Hog Rider',
    'Kid named finger',
    'Mike Ehrmantraut',
    'Batman',
    'Family from Fast and the Furious',
    'Matt\'s Brain',
    'pez the cum guzzler',
    'Tommy Shelby',
    'Tony Soprano',
    'Hank Schrader',
    'Marie Schrader',
    'Steve Jobs',
    'Bill Gates',
    'Obama (unknown)',
    'Trump',
    'Osama Bin Laden',
    'Steve from minecraft',
    'George Pell',
    'Jeffrey Dahmer',
    'Mike Tyson',
    'Nikola Tesla',
    'Jesus Christ',
    'Iron man from the movie "Iron Man"',
    'Iron man from the movie "Iron Man 2"',
    'Thor Odinson',
    'lore accurate aurelion sol',
    'Thanos',
    'Ryze',
    'Dababy Car',
    'Dragon Warrior',
    'Lightning Mqueen',
    'master oogway',
    'master shifu',
    'master tigress',
    'Pink Guy',
    'league of legends player',
    'Pewdiepie',
    'Lana Rhoades',
    'Mia Khalifa',
    'Johnny Sins',
    'George Floyd',
    'The cop who killed george floyd',
    'The Terminator',
    'Indiana Jones',
    'Luke Skywalker',
    'Darth Vader',
    'Obi-Wan Kenobi',
    'Darth Sidious',
    'Lizzo',
    'The Kardashians',
    'Imagine Dragons',
    'Viego',
    'Edward Bang your mum',
    'Atom',
    'Judas',
    'BIG BR0THER',
    'John Cena',
    'Freddy Mercury',
    'Elvis Presley',
    'FTR Chickens',
    'pesto101',
    'FTR Chickenz',
    'Ethan Bell',
    'Rythm Bot (prime)',
    'FTR mushroomking',
    'ashwoodsdo',
    'FTR chickenman',
    'Silver Talls',
    'FBI',
    'Julius Caeser',
    'Harry Potter',
    'He who shall not be named',
    'Leviathan',
    'Zeus',
    'Loki',
    'Valkyrie',
    'Atom (football player)',
    'Atom (vce study mode)',
    'Atom (Software engineer)',
    'Atom (swampass)',
    'Atom (short hair)',
    'Atom (league player)',
    'Atom (Jayce main)',
    'Atom (heimerdinger main)',
    'Atom (Jarvan IV main)',
    'Atom (learning gangplank)',
    'Atom (Tracksuit pants)',
    'Atom (2kg of pasta stomach)',
    'Atom (toastie devourer)',
    'Atom (fisherman)',
    'Atom (Volleyball Player)',
    'Atom (Boxer)',
    'Atom (not tone deaf)',
    'Atom (diep.io player)',
    'Dicks',
    'Cotton Picker',
    'Bird',
    'The CBT God',
    'aaaaaaaaaaaaaaaaaaaaaaaa',
    'Atom (soggy jocks)',
    'Johnny Sins (firefighter)',
    'Johnny Sins (Doctor)',
    'Johnn Sins (Teacher)',
    'Johnny Sins (Plumber)',
    'JVigger',
    'ishowspeed',
    'Mr. Beast',
    'Tyler Fucking 1',
    'Patrick Bateman',
    'Pesanator with crippling depression',
    'Nose\'s Nose',
    'Tyler1',
    'xQc',
    'mister oogay',
    'James May',
    'James may (CHEESE)',
    'Richard Hammond',
    'TRUCK MONTH',
    'Cock and ball torture device',
    'Horizontally Spinning Rat',
    'Ethan (Viego main)',
    'Im cumming in my pants',
    'The Boy who kissed BigPez on the Lips',
    'big cocks',
    'little cocks',
    'pez bouncing on cock',
    'xXDragonSlayerXx',
    'George Calombaris',
    'anthony dib',
    'Big dog',
    'Cum guzzler',
    'Adam Sandler',
    'joe rogan',
    'Jordan B. Peterson',
    'Linda Bleach Master',
    'Joeg',
    'xAXXGODKILLERXXAx',
    'Robbie Rotten',
    'Dora the Explorer',
    'Deez',
    'Nutz',
    'bottletopbill and his best friend corki',
    'Chad',
    'Brad',
    'adams ryze',
    'Adams jayce',
    'Adams ap jarvan support',
    'Atom (sore forearms)',
    'Adam (Crippled Gambling Addict)',
    'mester ogway',
    'mosta ogray',
    'Giraffe',
    'MISTER OOGAY THE CUM LORD HIMSELFD',
    'Peza (Ascended Gay Form)',
    'Jeffery "born in a bin" Bezos',
    'SMALL GLASS JAR',
    'One Guy (One Jar)',
    'Black guy from prison',
    'Shawshank',
    'Hans Zimmer',
    'Hanks Mineral Collection',
    'Atom (Aligned Chakras)',
    'Chronic Hemorrhoids',
    'Goku',
    'Naruto',
    'Godzilla',
    'Bidoof (dog racing winner)',
    'Bidoof (dog racing loser)',
    'Pezanator (In the Backrooms)',
    'John Connor',
    'A blimp',
    'Elmo\'s Nan Requis',
    'Big Brollic Black Dude',
    'Godzu',
    'Matty pez (Sex offender)',
    'The Top G',
    'Neo',
    'Norman Andy',
    'Bird\'s Large Girthy Meat',
    'xX NiggerSlayer Xx',
    'Morbius',
    'Matt Preston',
    'Alex (Herbivore)',
    'Alex (Elbows locked out)',
    'Alex (Sucking cock)',
    'Alfonzo',
    'Thong (Raging homosexual)',
    'Thong (Homosexual incarnate)',
    'Thong (Joe fucker)',
    'Salami Stroker',
    'Dick Beater',
    'God',
    'Al Pacino',
    'Robert De Niro',
    'An alpaca',
    'Hannibal Lector',
    'a rhino',
    'a lion',
    'a dragon',
    'Arnold Schwarzenegger',
    'Lightning Mcqueen',
    'Mater from cars',
    'Joey Tribbiani',
    'Spiderman (Tom Holland)',
    'Spiderman (Andrew Garfield)',
    'Spiderman (Toby Maguire)',
    'the blue people from avatar',
    'Will Smith',
    'Cristiano Ronaldo',
    'tomboshiztar',
    'Cumzilla',
    'atom (cum collector)',
    'atom (bum destroyer)',
    'atom (certified boy lover)',
    'prolific rapist',
    'Ultra rare straight Thong',
    'Mr Brooks (Braybrook)',
    'Kimmy Granger',
    'Riley Reid',
    'Thong (reformed homo)',
    'Thong(playing league)',
    'Thong(Cracked at everything)',
    'Thong(Mid joe fuck)',
    'Joe(God mode)',
    'A planet',
    'a plant',
    'Atom (bidoof\'s lover)',
    'Batman Toy',
    'The Red Amog Us',
    'The Red Amogus',
    'Jeffery Epstein (Ascended)',
    'bum eater',
    'prodoggambler',
    'spaces between words are for weirdos',
    'Joe Biden',
    'Dracula',
    'Israel',
    'Iraq',
    'George Bush',
    '2nd plane that flew into the twin towers',
    'Wolverine',
    'Pesatron',
    'Hercules',
    'King Kong',
    'Bilbo Baggins',
    'Katniss Everdeen',
    'Darth Vader',
    'Darth Maul',
    'Bugs Bunny',
    'James Bond',
    'Joker',
    'Hannah Montana',
    'Captain America',
    'The Hulk',
    'Yoda',
    'Joege',
    'Huge horse cock',
    'Homer',
    'Joes cock',
    'Kru Fairtex Joge',
    'Kru Fairtex Joege',
    'Han Solo',
    'Freddy Krueger',
    'Woody',
    'Peter Pan',
    'Rocky Balboa',
    'Spock',
    'Tarzan',
    'Jerry Seinfeld',
    'The Grinch',
    'Cheeseburger',
    'Porky Pig',
    'The minions',
    'Maximus Decimus Meridius',
    'Joaquin Phoenix',
    'Barbarians',
    'Golem',
    'Lava Hound',
    'Hog Rider (Cock Rider)',
    'My Little Pony',
    'Barbie',
    'Ken',
    'King Kong',
    'King Dong',
    'Donkey Kong',
    'Donkey Dong',
    'Kru Fairtex Thomas Odak',
    'AP Jarvan support',
    'Legolas',
    'Sheldon',
    'Jim Parsons',
    'Barney Stinson',
    'Lara Croft',
    'Yodeling kid',
    'Thor',
    'Adin Ross',
    'Drake',
    'Soyeon',
    'Miyeon',
    'Jar Jar Binks',
    'Jisoo',
    'Jungkook',
    'Lady Gaga',
    'Angry Birds',
    'Jennie',
    'Pompeii',
    'Green Day',
    'Justin Bieber',
    'Gary Vee',
    'Samantha Forbes',
    'Michael Jackson',
    'Shrek',
    'Donkey',
    'Geralt of Rivia',
    'Yennefer',
    'Humble Bard',
    'Kiev',
];


function random(min, max){
    return Math.floor(Math.random() * (max + 1 - min)) + min;
}

function gaussianRandom(mean, stdev) {
    let u = 1 - Math.random();
    let v = Math.random();
    let z = Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );
    return Math.round(z * stdev + mean);
}

class Fighter{
    constructor(){
        this.name = 0
        this.health = 0
        this.damageMin = 0
        this.damageMax = 0
        this.critChance = 0
        this.dodgeChance = 0
        this.minBlockAmount = 0
        this.maxBlockAmount = 0
        this.blockChance = 0
        this.siphonChance = 0
        this.chargeChance = 0
        this.speed = 0
        this.currentHealth = 0
    }
    displaySelf(){
        return `Name: ${this.name}<br>Health: ${this.currentHealth}/${this.health}<br>Damage: ${this.damageMin} - ${this.damageMax}<br>
                Crit Chance: ${this.critChance}%<br>Dodge Chance: ${this.dodgeChance}%<br>
                Block Amount: ${this.minBlockAmount} - ${this.maxBlockAmount}<br>
                Block Chance: ${this.blockChance}%<br>Siphon Chance: ${this.siphonChance}%<br>
                Charge Chance: ${this.chargeChance}%<br>Speed: ${this.speed}`;
    }
}


function battle(f1, f2){
    
    if (f1.speed === f2.speed){
        attack(f1, f2, true)
    }
    else if (f1.speed > f2.speed){
        attack(f1, f2, false)
    }
    else{
        attack(f2, f1, false)
    }

    pick1Text.innerHTML = f1.displaySelf();
    enemyText.innerHTML = f2.displaySelf();
    
    
    if (f1.currentHealth <= 0){
        logText.innerHTML += `${f2.name} has defeated ${f1.name}<br>`
        if (fighters.length === 1){
            attackButton.style.display = "none";
            swapButton.style.display = "none";
            catchButton.style.display = "none";
            continueButton.style.display = "initial";
            logText.innerHTML += `no more fighters left, game over<br>`
            score = 0;
            fighters.splice(0,1);
        }
        else{
            fighters.splice(0, 1);
            if (fighters.length === 2){
                pick1Text.innerHTML = fighters[0].displaySelf();
                pick2Text.innerHTML = fighters[1].displaySelf();
                pick3Text.innerHTML = "";
                playerFighter = fighters[0];
            }
            else{
                pick1Text.innerHTML = fighters[0].displaySelf();
                pick2Text.innerHTML = "";
                playerFighter = fighters[0]
            }
            
            
        }
    }
    else if (f2.currentHealth <= 0){
        logText.innerHTML += `${f1.name} has defeated ${f2.name}<br>`
        attackButton.style.display = "none";
        swapButton.style.display = "none";
        catchButton.style.display = "none";
        continueButton.style.display = "initial";
        score++;
        scoreText.innerHTML = `score: ${score}`;
    }
    else{
        
    }
}
        


function attack(first, second, tie){
    secondFirst = false
    if(tie){
        speedTie = random(0,1)
        if(speedTie === 0){
            turn(first, second)
        }
        else{
            turn(second, first)
            secondFirst = true
        }
    }
    else{
        turn(first, second)
    }

    if(secondFirst === false){
        if (second.currentHealth <= 0){
            return false
        }

        turn(second, first)
        if (first.currentHealth <= 0){
            return false
        }
        else{
            return true
        }
    }
    else{
        if (first.currentHealth <= 0){
            return false
        }
    

        turn(first, second)
        if (second.currentHealth <= 0){
            return false
        }
        else{
            return true
        }
    }
}

function turn(attacker, defender){
    damage = random(attacker.damageMin, attacker.damageMax);
    attackerCrit = random(0, 100) - attacker.critChance;
    attackerSiphon = random(0,100) - attacker.siphonChance;
    attackerCharge = random(0,100) - attacker.chargeChance;
    defenderDodge = random(0, 100) - defender.dodgeChance;
    defenderBlock = random(0, 100) - defender.blockChance;

    modifiers = [];
    
    if(attackerCharge < 0){
        damage = damage + attacker.speed
        modifiers.push("charges ")
    }
    if(attackerCrit < 0){
        damage = damage * 2
        modifiers.push("crits ")
    }
    if(attackerSiphon < 0){
        heal = damage
        modifiers.push("siphons ")
    }

    if(modifiers.length > 0){
        modifierString = modifiers.join("")
    }
    else{
        modifierString = 'attacks '
    }

    if (defenderDodge < 0){
        logText.innerHTML += `${defender.name} dodges ${attacker.name} attack<br>`
    }
    else if (defenderBlock < 0){
        blockAmount = random(defender.minBlockAmount, defender.maxBlockAmount)
        unblockedDamage = damage - blockAmount
        if(unblockedDamage < 0){
            unblockedDamage = 0
        }
        defender.currentHealth = defender.currentHealth - unblockedDamage
        logText.innerHTML += `${attacker.name} ${modifierString}${defender.name} for ${damage} damage, ${defender.name} blocks ${damage - unblockedDamage} damage || ${defender.name} : ${defender.currentHealth + unblockedDamage} -> ${defender.currentHealth}<br>`
    }
    else if (attackerSiphon < 0){
        defender.currentHealth = defender.currentHealth - damage
        attacker.currentHealth = attacker.currentHealth + heal
        logText.innerHTML += `${attacker.name} ${modifierString}${defender.name} for ${damage} damage, healing for ${heal} || ${defender.name} : ${defender.currentHealth + damage} -> ${defender.currentHealth}, ${attacker.name} : ${attacker.currentHealth - heal} -> ${attacker.currentHealth}<br>`
    }
    else if (modifiers.length > 0){
        defender.currentHealth = defender.currentHealth - damage
        logText.innerHTML += `${attacker.name} ${modifierString}${defender.name} for ${damage} damage || ${defender.name} : ${defender.currentHealth + damage} -> ${defender.currentHealth}<br>`
    }
    else{
        defender.currentHealth = defender.currentHealth - damage
        logText.innerHTML += `${attacker.name} attacks ${defender.name} for ${damage} damage || ${defender.name} : ${defender.currentHealth + damage} -> ${defender.currentHealth}<br>`
    }
}

function normalGen(){
    fighter = new Fighter()
    fighter.name = names[random(0, names.length - 1)];
    fighter.health = gaussianRandom(75, 15);
    fighter.damageMin = gaussianRandom(10, 7); 
    fighter.damageMax = gaussianRandom(30, 7);
    fighter.critChance =  gaussianRandom(25, 15);
    fighter.dodgeChance =  gaussianRandom(25, 15); 
    fighter.minBlockAmount = gaussianRandom(10, 7); 
    fighter.maxBlockAmount = gaussianRandom(30, 7);
    fighter.blockChance =  gaussianRandom(25, 15);
    fighter.siphonChance = gaussianRandom(10, 7);
    fighter.chargeChance = gaussianRandom(10, 7);
    fighter.speed = gaussianRandom(50, 25);
    if(fighter.health < 1){
        fighter.health = 1;
    }
    if(fighter.damageMin < 0){
        fighter.damageMin = 0;
    }
    if(fighter.damageMax < fighter.damageMin){
        fighter.damageMax = fighter.damageMin;
    }
    if(fighter.minBlockAmount < 0){
        fighter.minBlockAmount = 0;
    }
    if(fighter.maxBlockAmount < fighter.minBlockAmount){
        fighter.maxBlockAmount = fighter.minBlockAmount;
    }
    if(fighter.speed < 0){
        fighter.speed = 0;
    }
    if(fighter.critChance < 0){
        fighter.critChance = 0;
    }
    if(fighter.dodgeChance < 0){
        fighter.dodgeChance = 0;
    }
    if(fighter.blockChance < 0){
        fighter.blockChance = 0;
    }
    if(fighter.siphonChance < 0){
        fighter.siphonChance = 0;
    }
    if(fighter.chargeChance < 0){
        fighter.chargeChance = 0;
    }
    fighter.currentHealth = fighter.health;
    return fighter;
}

function lockToBottom() {
    logText.classList.add('locked-to-bottom');
    logText.scrollTop = logText.scrollHeight;
}

// Selecting items from the DOM
const logText = document.querySelector('.textbox');
const pick1Text = document.querySelector('.pick1');
const pick2Text = document.querySelector('.pick2');
const pick3Text = document.querySelector('.pick3');
const enemyText = document.querySelector('.enemy');
const scoreText = document.querySelector('.score');
const attackButton = document.querySelector('#attack');
const swapButton = document.querySelector('#swap');
const catchButton = document.querySelector('#catch');
const continueButton = document.querySelector('#continue');
const rerollButton = document.querySelector('#reroll');
const selectButton = document.querySelector('#select');
const reserve1Button = document.querySelector('#reserve1');
const reserve2Button = document.querySelector('#reserve2');
const cancelButton = document.querySelector('#cancel');

attackButton.style.display = "none";
swapButton.style.display = "none";
catchButton.style.display = "none";
continueButton.style.display = "none";
reserve1Button.style.display = "none";
reserve2Button.style.display = "none";
cancelButton.style.display = "none";
logText.addEventListener('DOMNodeInserted', lockToBottom);

// Code starts here
let playerFighter = normalGen();
pick1Text.innerHTML = playerFighter.displaySelf();
let enemyFighter;
let fighters = [];
let score = 0;

// Buttons
attackButton.addEventListener('click',() => {
    battle(playerFighter, enemyFighter);
    logText.innerHTML += `------------------------------------------------<br>`;
});

swapButton.addEventListener('click',() => {
    attackButton.style.display = "none";
    swapButton.style.display = "none";
    catchButton.style.display = "none";
    reserve1Button.style.display = "initial";
    reserve2Button.style.display = "initial";
    cancelButton.style.display = "initial";
});

catchButton.addEventListener('click',() => {
    if (fighters.length < 3){
        if (enemyFighter.currentHealth - random(0, enemyFighter.health) < 0){
            logText.innerHTML += "catch successful<br>"
            fighters.push(enemyFighter);
            enemyFighter.currentHealth = enemyFighter.health;
            if(pick2Text.innerHTML === ""){
                pick2Text.innerHTML = enemyFighter.displaySelf();
            }
            else if(pick3Text.innerHTML === ""){
                pick3Text.innerHTML = enemyFighter.displaySelf();
            }
            attackButton.style.display = "none";
            swapButton.style.display = "none";
            catchButton.style.display = "none";
            continueButton.style.display = "initial";
        }
        else{
            turn(enemyFighter, playerFighter);
            if (playerFighter.currentHealth <= 0){
                logText.innerHTML += `${enemyFighter.name} has defeated ${playerFighter.name}<br>`
                if (fighters.length === 1){
                    attackButton.style.display = "none";
                    swapButton.style.display = "none";
                    catchButton.style.display = "none";
                    continueButton.style.display = "initial";
                    logText.innerHTML += `no more fighters left, game over`
                    fighters.splice(0,1);
                }
                else{
                    fighters.splice(0, 1);
                    if (fighters.length === 2){
                        pick1Text.innerHTML = fighters[0].displaySelf();
                        pick2Text.innerHTML = fighters[1].displaySelf();
                        pick3Text.innerHTML = "";
                        playerFighter = fighters[0];
                    }
                    else{
                        pick1Text.innerHTML = fighters[0].displaySelf();
                        pick2Text.innerHTML = "";
                        playerFighter = fighters[0]
                    }
                    
                    
                }
            }
            pick1Text.innerHTML = playerFighter.displaySelf();
            enemyText.innerHTML = enemyFighter.displaySelf();
        }
    }
    else{
        logText.innerHTML += "already at max fighters<br>"
    }
});

continueButton.addEventListener('click',() => {
    if(fighters.length == 0){
        playerFighter = normalGen();
        pick1Text.innerHTML = playerFighter.displaySelf();
        enemyText.innerHTML = ``;
        logText.innerHTML = ``;
        attackButton.style.display = "none";
        swapButton.style.display = "none";
        catchButton.style.display = "none";
        rerollButton.style.display = "initial";
        selectButton.style.display = "initial";
        continueButton.style.display = "none";
    }
    else{
        enemyFighter = normalGen();
        enemyFighter.name = names[random(0, names.length - 1)];
        enemyText.innerHTML = enemyFighter.displaySelf();
        attackButton.style.display = "initial";
        swapButton.style.display = "initial";
        catchButton.style.display = "initial";
        continueButton.style.display = "none";
        logText.innerHTML = "";
    }
});

rerollButton.addEventListener('click',() => {
    playerFighter = normalGen();
    // console.log(JSON.stringify(playerFighter, null, 4));
    pick1Text.innerHTML = playerFighter.displaySelf();
});

selectButton.addEventListener('click',() => {
    attackButton.style.display = "initial";
    swapButton.style.display = "initial";
    catchButton.style.display = "initial";
    rerollButton.style.display = "none";
    selectButton.style.display = "none";
    enemyFighter = normalGen();
    enemyFighter.name = names[random(0, names.length - 1)];
    enemyText.innerHTML = enemyFighter.displaySelf();
    fighters.push(playerFighter);
});

reserve1Button.addEventListener('click',() => {
    if (fighters.length < 2){
        logText.innerHTML += `no fighter in reserve 1<br>`;
    }
    else{
        temp = fighters[0];
        fighters[0] = fighters[1];
        fighters[1] = temp;
        pick1Text.innerHTML = fighters[0].displaySelf();
        pick2Text.innerHTML = fighters[1].displaySelf();
        playerFighter = fighters[0];
    }
    attackButton.style.display = "initial";
    swapButton.style.display = "initial";
    catchButton.style.display = "initial";
    reserve1Button.style.display = "none";
    reserve2Button.style.display = "none";
    cancelButton.style.display = "none";
});

reserve2Button.addEventListener('click',() => {
    if (fighters.length < 3){
        logText.innerHTML += `no fighter in reserve 2<br>`;
    }
    else{
        temp = fighters[0];
        fighters[0] = fighters[2];
        fighters[2] = temp;
        pick1Text.innerHTML = fighters[0].displaySelf();
        pick3Text.innerHTML = fighters[2].displaySelf();
        playerFighter = fighters[0];
    }
    attackButton.style.display = "initial";
    swapButton.style.display = "initial";
    catchButton.style.display = "initial";
    reserve1Button.style.display = "none";
    reserve2Button.style.display = "none";
    cancelButton.style.display = "none";
});

cancelButton.addEventListener('click',() => {
    attackButton.style.display = "initial";
    swapButton.style.display = "initial";
    catchButton.style.display = "initial";
    reserve1Button.style.display = "none";
    reserve2Button.style.display = "none";
    cancelButton.style.display = "none";
});

/*

Testing randomness

const gaussvalues = [];

for (i = 0; i < 100000; i++){
    gaussvalues.push(gaussianRandom(100, 20));
}

gaussvalues.sort(function(a, b){return a - b});
console.log(gaussvalues);
console.log(gaussvalues[0] + " and "+ gaussvalues[values.length - 1]);


const values = [];

for (i = 0; i < 10; i++){
    values.push(random(0, 1));
}

const counts = {};

for (const num of values) {
  counts[num] = counts[num] ? counts[num] + 1 : 1;
}

for (i = 0; i < 2; i++){
    console.log(i + " : " + counts[i]);
}

*/

